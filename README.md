# AInews v2.4.1 - æ™ºèƒ½æ–°é—»å¤„ç†ç³»ç»Ÿ

> ğŸ‰ **æœ€æ–°ç‰ˆæœ¬**: v2.4.1 - ç³»ç»Ÿé…ç½®ä¼˜åŒ–ç‰ˆæœ¬  
> ğŸ“… **å‘å¸ƒæ—¥æœŸ**: 2025å¹´8æœˆ5æ—¥  
> ğŸš€ **ä¸»è¦æ›´æ–°**: åŒé‡è¯é¢˜æŠ‘åˆ¶ã€è°ƒåº¦æ—¶é—´ä¼˜åŒ–ã€æ–‡ä»¶è¾“å‡ºè·¯å¾„ä¿®å¤

## ğŸ¯ ç³»ç»Ÿæ¦‚è¿°

AInews v2.4.1 æ˜¯ä¸€ä¸ªåŸºäº EventRegistry çš„æ™ºèƒ½æ–°é—»å¤„ç†ç³»ç»Ÿï¼Œé›†æˆäº†ç‹¬ç«‹çš„ Phoenix æ–°é—»å¤„ç†ç®¡é“ã€‚ç³»ç»Ÿé€šè¿‡èšç±»ã€æ‰“åˆ†ã€è¯é¢˜æŠ‘åˆ¶å’Œè‡ªåŠ¨è°ƒå‚ï¼Œå®ç°é«˜è´¨é‡çš„æ–°é—»äº‹ä»¶å»åŒè´¨åŒ–ï¼Œä¸ºé›¶ GPT ä¾èµ–çš„æ–°é—»æ±‡æ€»æä¾›æ•°æ®åŸºç¡€ã€‚

### v2.4.1 æ–°ç‰¹æ€§
- **åŒé‡è¯é¢˜æŠ‘åˆ¶**: å¸¸è§„è¯é¢˜æŠ‘åˆ¶ + é¢†åŸŸè¯é¢˜é™æƒæœºåˆ¶
- **é«˜æ€§èƒ½å‘é‡åŒ–ç®—æ³•**: æå‡20-30%å¤„ç†æ•ˆç‡
- **è°ƒåº¦æ—¶é—´ä¼˜åŒ–**: ä»æ¯å¤©3æ¬¡æ”¹ä¸ºæ¯å¤©1æ¬¡è¿è¡Œï¼Œå‡å°‘66%èµ„æºæ¶ˆè€—
- **æ–‡ä»¶è¾“å‡ºè·¯å¾„ä¿®å¤**: ç¡®ä¿æ–‡ä»¶è¾“å‡ºåˆ°æ­£ç¡®ä½ç½®
- **æƒå¨åˆ†è®¡ç®—ä¿®å¤**: åŸºäºçœŸå®ä¿¡æºæ’åçš„æƒå¨åˆ†è®¡ç®—
- **åŒè·¯å¹¶è¡ŒæŠ“å–**: åŒæ—¶è·å–çƒ­é—¨å’Œçªå‘äº‹ä»¶

## ğŸš€ æ ¸å¿ƒç‰¹æ€§

### 1. Phoenix ç‹¬ç«‹ç³»ç»Ÿ
- **ç‹¬ç«‹æ•°æ®åº“ç¯å¢ƒ**: ä¸“ç”¨çš„ Phoenix PostgreSQL æ•°æ®åº“
- **é«˜çº§æ–°é—»è¯„åˆ†**: åŸºäºæœºå™¨å­¦ä¹ çš„æ–°é—»é‡è¦æ€§è¯„åˆ†ç³»ç»Ÿ
- **æ™ºèƒ½èšç±»**: æ”¹è¿›çš„ä¸»é¢˜èšç±»å’Œäº‹ä»¶å…³è”ç®—æ³•
- **åŒ—äº¬æ—¶é—´æ”¯æŒ**: è‡ªåŠ¨æ—¶åŒºè½¬æ¢ï¼Œç¡®ä¿æ‰€æœ‰æ—¶é—´æ•°æ®ä½¿ç”¨åŒ—äº¬æ—¶é—´

### 2. æ™ºèƒ½èšç±»
- **ä¸€çº§èšç±»**ï¼šåŸºäº EventRegistry çš„ event_id è¿›è¡Œäº‹ä»¶çº§èšç±»
- **äºŒçº§èšç±»**ï¼šå¯¹è¶…å¤§äº‹ä»¶ï¼ˆ>50æ¡ï¼‰è¿›è¡Œç»†åˆ†èšç±»
- **èšç±»ä¸­å¿ƒ**ï¼šè®¡ç®—ä¸èšç±»ä¸­å¿ƒçš„ä½™å¼¦ç›¸ä¼¼åº¦

### 3. äº”ç»´åº¦æ‰“åˆ† + è¯é¢˜æŠ‘åˆ¶ (v2.4.1 å‡çº§)
- **çƒ­åº¦åˆ†æ•°**ï¼šåŸºäºæ—¶é—´è¡°å‡ + EventRegistry å­—æ®µï¼ˆtotal_articles_24hã€source_importanceã€wgtï¼‰
- **æƒå¨åˆ†æ•°**ï¼šåŸºäºçœŸå®ä¿¡æºæ’åï¼ˆimportanceRankï¼‰
- **æ¦‚å¿µçƒ­åº¦åˆ†æ•°**ï¼šåŸºäºå®ä½“çƒ­åº¦è¯„åˆ†
- **æ–°é²œåˆ†æ•°**ï¼šåŸºäºæ—¶åŒºæ„ŸçŸ¥çš„æ—¶æ•ˆæ€§è®¡ç®—
- **æƒ…æ„Ÿåˆ†æ•°**ï¼šåŸºäºæƒ…æ„Ÿåˆ†æç»å¯¹å€¼å½’ä¸€åŒ–
- **è¯é¢˜æŠ‘åˆ¶**ï¼šå¸¸è§„è¯é¢˜æŠ‘åˆ¶ï¼ˆå¼ºåº¦0.3ï¼‰+ é¢†åŸŸè¯é¢˜é™æƒï¼ˆå¼ºåº¦0.5ï¼‰
- **ç»¼åˆåˆ†æ•°**ï¼šäº”ç»´åº¦åŠ æƒå¹³å‡ + æŠ‘åˆ¶æ•ˆæœ

### 4. è‡ªåŠ¨è°ƒå‚
- **æ¯å‘¨è‡ªå­¦ä¹ **ï¼šåŸºäºå†å²æ•°æ®è‡ªåŠ¨ä¼˜åŒ–å‚æ•°
- **Î²_iä¼˜åŒ–**ï¼šçƒ­åº¦å­æƒé‡è‡ªåŠ¨è°ƒæ•´
- **w_jä¼˜åŒ–**ï¼šç»´åº¦æ··åˆæƒé‡è‡ªåŠ¨è°ƒæ•´

### 5. é›¶GPTä¾èµ–
- **çº¯æ•°æ®é©±åŠ¨**ï¼šåŸºäº EventRegistry å­—æ®µè¿›è¡Œå»åŒè´¨åŒ–
- **å¯ç›´æ¥ç”Ÿæˆæ±‡æ€»æ—¥å¿—**ï¼šä¸ºä¸‹ä¸€ç¯èŠ‚æä¾›é«˜è´¨é‡æ•°æ®

## ğŸ“Š ç³»ç»Ÿæ¶æ„

### åŒç³»ç»Ÿæ¶æ„

#### Phoenix ç³»ç»Ÿï¼ˆv2.4.1 æœ€æ–°ï¼‰
```
Phoenix ç‹¬ç«‹ç¯å¢ƒ
â”œâ”€â”€ ä¸“ç”¨æ•°æ®åº“ (ç«¯å£ 5434)
â”œâ”€â”€ ç‹¬ç«‹ Airflow (ç«¯å£ 8082)
â”œâ”€â”€ é«˜çº§è¯„åˆ†ç®—æ³• + è¯é¢˜æŠ‘åˆ¶
â”œâ”€â”€ åŒ—äº¬æ—¶é—´æ”¯æŒ
â””â”€â”€ ä¼˜åŒ–è°ƒåº¦é…ç½®
```

#### ä¸»ç³»ç»Ÿï¼ˆv1.0 å…¼å®¹ï¼‰
```
ä¸»ç³»ç»Ÿç¯å¢ƒ
â”œâ”€â”€ ä¸»æ•°æ®åº“ (ç«¯å£ 5432)
â”œâ”€â”€ ä¸» Airflow (ç«¯å£ 8080)
â”œâ”€â”€ åŸºç¡€è¯„åˆ†ç®—æ³•
â””â”€â”€ å…¼å®¹æ€§æ”¯æŒ
```

### ä¸¤å¥—å¹¶è¡Œæ•°æ®æµ

#### æ–¹æ¡ˆAï¼šç›´æ¥æ•°æ®åº“æµï¼ˆä¸»è¦æµç¨‹ï¼‰
```
ingestion_scoring_pipeline (22:00)  # v2.4.1ä¼˜åŒ–ï¼šæ¯å¤©1æ¬¡
    â†“ ç›´æ¥å†™å…¥æ•°æ®åº“ (raw_eventsè¡¨)
summary_generation_dag (23:00)
    â†“ ä»æ•°æ®åº“è¯»å–å¹¶å¤„ç†
èšç±» â†’ æ‰“åˆ† â†’ è¯é¢˜æŠ‘åˆ¶ â†’ æ±‡æ€»
```

#### æ–¹æ¡ˆBï¼šæ—¥å¿—æ±‡æ€»æµï¼ˆä¿ç•™åŠŸèƒ½ï¼‰
```
fetch_eventregistry_news (10:00/17:00/22:00)
    â†“ å†™å…¥æ—¥å¿—æ–‡ä»¶ (logs/news/{source}/)
aggregate_daily_logs (00:00)
    â†“ æ±‡æ€»æ—¥å¿—æ–‡ä»¶
ç”Ÿæˆæ±‡æ€»æ–‡ä»¶ (logs/news/summary/)
```

## ğŸ”§ å®Œæ•´æµç¨‹ï¼ˆPhoenixï¼‰

```bash
# 1) è§¦å‘Phoenixæ–°é—»é‡‡é›†ä¸æ‰“åˆ†ï¼ˆç»Ÿä¸€æµç¨‹ï¼‰
docker-compose -f docker-compose.phoenix.yml exec phoenix-webserver \
  airflow dags trigger ingestion_scoring_pipeline

# 2) ç”Ÿæˆæ¯æ—¥æ‘˜è¦JSONï¼ˆè¾“å‡ºåˆ° dev/exports/ï¼‰
docker-compose -f docker-compose.phoenix.yml exec phoenix-webserver \
  airflow dags trigger summary_generation_dag
```

## ğŸ“ˆ ç›‘æ§æŒ‡æ ‡ï¼ˆPhoenixï¼‰

### æŠ‘åˆ¶æ•ˆæœç›‘æ§ï¼ˆæœ€è¿‘24å°æ—¶ï¼‰
```sql
SELECT 
    COUNT(*)                                 AS total_articles_24h,
    COUNT(CASE WHEN is_routine_topic   THEN 1 END) AS routine_topic_articles,
    COUNT(CASE WHEN is_category_topic  THEN 1 END) AS category_topic_articles,
    COUNT(CASE WHEN is_breaking_news   THEN 1 END) AS breaking_news_articles,
    COUNT(CASE WHEN is_suppressed      THEN 1 END) AS suppressed_articles,
    COUNT(CASE WHEN is_downweighted    THEN 1 END) AS downweighted_articles,
    ROUND(COUNT(CASE WHEN is_suppressed   THEN 1 END) * 100.0 / COUNT(*), 2) AS suppression_rate,
    ROUND(COUNT(CASE WHEN is_downweighted THEN 1 END) * 100.0 / COUNT(*), 2) AS downweight_rate
FROM raw_events 
WHERE published_at >= NOW() - INTERVAL '24 HOURS';
```

### æ‰“åˆ†åˆ†å¸ƒç›‘æ§ï¼ˆä½¿ç”¨ final_score_v2ï¼‰
```sql
SELECT 
    COUNT(*) AS total_records,
    COUNT(CASE WHEN final_score_v2 >= 0.6 THEN 1 END) AS high_score_records,
    AVG(final_score_v2) AS avg_score
FROM raw_events 
WHERE final_score_v2 IS NOT NULL 
  AND published_at >= NOW() - INTERVAL '24 HOURS';
```

## ğŸ› ï¸ ç¯å¢ƒé…ç½®

### 1. æ•°æ®åº“é…ç½®
```bash
# æ£€æŸ¥æ•°æ®åº“è¿æ¥
# Phoenix
docker compose -f docker-compose.phoenix.yml exec postgres-phoenix \
  psql -U phoenix_user -d phoenix_db -c "SELECT version();"
```

### 2. EventRegistry APIé…ç½®
```bash
# è®¾ç½®API Key
export EVENTREGISTRY_APIKEY=ä½ çš„APIå¯†é’¥
```

### 3. ä¾èµ–å®‰è£…
```bash
#ï¼ˆå¼€å‘ç¯å¢ƒï¼‰
docker-compose -f docker-compose.phoenix.yml exec phoenix-webserver \
  pip install -r requirements.txt
```

## ğŸ“ é¡¹ç›®ç»“æ„ï¼ˆæ ¸å¿ƒï¼‰

```
dev/
â”œâ”€â”€ dags/
â”‚   â””â”€â”€ phoenix/
â”‚       â”œâ”€â”€ ingestion_scoring_pipeline_dag.py   # é‡‡é›†+é«˜çº§æ‰“åˆ†
â”‚       â”œâ”€â”€ summary_generation_dag.py           # æ¯æ—¥æ‘˜è¦ç”Ÿæˆ(JSON)
â”‚       â””â”€â”€ advanced_scorer.py / json_report_generator.py
â”œâ”€â”€ docker-compose.phoenix.yml
â”œâ”€â”€ exports/                                    # Phoenix æ‘˜è¦è¾“å‡ºç›®å½•
â”œâ”€â”€ docs/
â”œâ”€â”€ scripts/
â”œâ”€â”€ sql/
â””â”€â”€ utils/
```

## â° DAGè°ƒåº¦é…ç½®ï¼ˆåŒ—äº¬æ—¶é—´ï¼‰

| DAG | åŠŸèƒ½ | è°ƒåº¦æ—¶é—´ | Cronè¡¨è¾¾å¼ | çŠ¶æ€ |
|-----|------|----------|------------|------|
| ingestion_scoring_pipeline | Phoenixæ–°é—»é‡‡é›†ä¸æ‰“åˆ† | 22:00 | 0 14 * * * | âœ… æ´»è·ƒ |
| summary_generation_dag | Phoenixæ‘˜è¦ç”Ÿæˆ | 23:00 | 0 15 * * * | âœ… æ´»è·ƒ |
| aggregate_daily_logs | æ—¥å¿—æ±‡æ€»ï¼ˆå¤‡ç”¨æµï¼‰ | 00:00 | 0 0 * * * | âš ï¸ å¤‡ç”¨ |

## ğŸ—‘ï¸ å·²ä¸‹çº¿åŠŸèƒ½ä¸DAG

ä¸‹è¡¨åˆ—å‡ºäº†è¿‘æœŸä¸‹çº¿/åºŸå¼ƒçš„åŠŸèƒ½ä¸DAGï¼Œä»¥åŠåŸå› ä¸æ›¿ä»£æ–¹æ¡ˆï¼Œç¡®ä¿è¯»è€…æŸ¥é˜…æ–‡æ¡£æ—¶ä¸èµ°æ—§è·¯å¾„ã€‚

| åç§° | ç±»å‹ | çŠ¶æ€ | ä¸‹çº¿åŸå›  | æ›¿ä»£æ–¹æ¡ˆ/è¯´æ˜ |
|---|---|---|---|---|
| fetch_twitter | DAG | å·²ä¸‹çº¿ | å¹³å°é™åˆ¶ã€ä¿¡å™ªæ¯”ä½ã€ç»´æŠ¤æˆæœ¬é«˜ | æš‚æ— æ›¿ä»£ï¼›å¦‚éœ€ç¤¾åª’æ•°æ®ï¼Œåç»­ä»¥å¤–éƒ¨æ•°æ®æºå¯¼å…¥ä¸ºå‡† |
| make_daily_cards | DAG | å·²ä¸‹çº¿ | ä¸æ–°æ‘˜è¦äº§å‡ºé‡å¤ | ä½¿ç”¨ `summary_generation_dag` ç”ŸæˆJSONæ‘˜è¦æ–‡ä»¶ |
| fetch_news | DAG | å·²ä¸‹çº¿ | æ—§ç‰ˆæŠ“å–ä¸è¯„åˆ†å·²è¢«æ•´åˆ | ä½¿ç”¨ `ingestion_scoring_pipeline` ç»Ÿä¸€æŠ“å–+è¯„åˆ† |
| parse_summary_logs | DAG | å·²ä¸‹çº¿ | ä¸æ•°æ®åº“ç›´è¯»é‡å¤ | æ—¥å¿—æ±‡æ€»ä¿ç•™å¤‡ç”¨ï¼š`aggregate_daily_logs`ï¼Œä»…ç”¨äºè°ƒè¯•/å®¡è®¡ |
| pipeline/daily_summary | åŠŸèƒ½ | å·²ä¸‹çº¿ | ä¸ Phoenix æ‘˜è¦äº§å‡ºé‡å¤ | ä½¿ç”¨ `summary_generation_dag`ï¼ˆè¾“å‡ºè‡³ `dev/exports/`ï¼‰ |

> æé†’ï¼šPhoenix ä¸»è·¯å¾„ä¸º `ingestion_scoring_pipeline â†’ DB â†’ summary_generation_dag`ã€‚æ—¥å¿—æ±‡æ€»æµä»…ä½œå¤‡ä»½ç”¨é€”ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å¯åŠ¨æœåŠ¡
```bash
# å¯åŠ¨Phoenixç³»ç»Ÿï¼ˆæ¨èï¼‰
docker-compose -f docker-compose.phoenix.yml up -d

# æ£€æŸ¥æœåŠ¡çŠ¶æ€
docker-compose -f docker-compose.phoenix.yml ps
```

### 2. è®¿é—®Webç•Œé¢
- **Phoenix Airflow UI**: http://localhost:8082 (ç”¨æˆ·å: phoenix_admin, å¯†ç : phoenix123)
- **Phoenix PgAdmin**: http://localhost:5051 (ç”¨æˆ·å: phoenix@example.com, å¯†ç : phoenix123)

### 3. æ‰‹åŠ¨è§¦å‘DAG
```bash
# è§¦å‘Phoenixæ–°é—»é‡‡é›†ä¸æ‰“åˆ†
docker-compose -f docker-compose.phoenix.yml exec phoenix-webserver airflow dags trigger ingestion_scoring_pipeline

# è§¦å‘Phoenixæ‘˜è¦ç”Ÿæˆ
docker-compose -f docker-compose.phoenix.yml exec phoenix-webserver airflow dags trigger summary_generation_dag
```

## ğŸ“ æ–‡æ¡£

- [v2.4.1å‘å¸ƒè¯´æ˜](RELEASE_V2.4.1.md) - v2.4.1ç‰ˆæœ¬è¯¦ç»†å‘å¸ƒè¯´æ˜
- [v2.4.0å‘å¸ƒè¯´æ˜](RELEASE_V2.4.0.md) - v2.4.0ç‰ˆæœ¬è¯¦ç»†å‘å¸ƒè¯´æ˜
- [ç‰ˆæœ¬æ¼”è¿›æ€»ç»“](VERSION_SUMMARY.md) - å®Œæ•´çš„ç‰ˆæœ¬æ¼”è¿›å†å²
- [è¯é¢˜æŠ‘åˆ¶å®ç°æ–‡æ¡£](docs/topic_suppression_implementation.md) - åŒé‡è¯é¢˜æŠ‘åˆ¶åŠŸèƒ½å®ç°
- [ç”Ÿäº§ç¯å¢ƒéªŒè¯æŒ‡å—](docs/production_verification_guide.md) - ç”Ÿäº§ç¯å¢ƒéªŒè¯æŒ‡å—
- [ç³»ç»Ÿæ¶æ„æ–‡æ¡£](docs/system_architecture.md) - è¯¦ç»†çš„ç³»ç»Ÿæ¶æ„è¯´æ˜
- [æ—¥å¿—æ±‡æ€»æ–‡æ¡£](docs/log_aggregation.md) - æ—¥å¿—æ±‡æ€»æµç¨‹è¯´æ˜ï¼ˆå¤‡ç”¨æµï¼‰ 